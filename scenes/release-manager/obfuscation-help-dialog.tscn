[gd_scene load_steps=2 format=3]

[ext_resource type="Script" path="res://scenes/release-manager/obfuscation-help-dialog.gd" id="1"]

[node name="ObfuscationHelpDialog" type="Window"]
title = "Obfuscation Guide"
initial_position = 2
size = Vector2i(700, 600)
script = ExtResource("1")

[node name="MarginContainer" type="MarginContainer" parent="."]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 10.0
offset_top = 10.0
offset_right = -10.0
offset_bottom = -10.0

[node name="VBoxContainer" type="VBoxContainer" parent="MarginContainer"]
layout_mode = 2

[node name="ScrollContainer" type="ScrollContainer" parent="MarginContainer/VBoxContainer"]
layout_mode = 2
size_flags_vertical = 3

[node name="HelpContent" type="RichTextLabel" parent="MarginContainer/VBoxContainer/ScrollContainer"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3
bbcode_enabled = true
text = "[b]Obfuscation Guide[/b]

This guide explains how obfuscation works in godot-valet and best practices for using it.

---

[b][size=14]1. Function Obfuscation[/size][/b]

[b]What it does:[/b]
‚Ä¢ Renames all user functions to random 8-character names
‚Ä¢ Example: [code]SaveGame()[/code] ‚Üí [code]XyZaBcDe()[/code]

[b]What's preserved:[/b]
‚Ä¢ Godot lifecycle methods: [code]_ready[/code], [code]_process[/code], [code]_input[/code], [code]_physics_process[/code], etc.
‚Ä¢ String-based reflection: [code]call(\"FunctionName\")[/code], [code]has_method(\"FunctionName\")[/code]

[b]Callable patterns handled automatically:[/b]
‚Ä¢ Direct references: [code]ApplyDamage.bind()[/code] ‚Üí [code]XyZaBcDe.bind()[/code]
‚Ä¢ Signal connections: [code].connect(my_function.bind(arg))[/code]
‚Ä¢ Thread callbacks: [code]Thread.start(my_function.bind(arg))[/code]

[b]Exclude-lists:[/b]
‚Ä¢ Use the \"Excludes...\" button to preserve specific function names
‚Ä¢ Useful for functions accessed via string reflection that we can't auto-detect

[b]‚ö†Ô∏è Warning:[/b]
Functions accessed via reflection patterns we don't detect should be added to exclude-list:
‚Ä¢ [code]Callable(self, \"FunctionName\")[/code] - string constructor
‚Ä¢ Custom reflection systems

---

[b][size=14]2. Variable Obfuscation[/size][/b]

[b]What it does:[/b]
‚Ä¢ Renames all variables to random names
‚Ä¢ Example: [code]player_health[/code] ‚Üí [code]AbCdEfGh[/code]

[b]What's preserved:[/b]
‚Ä¢ String literals in your code (URLs, text, messages remain readable)

[b]Exclude-lists:[/b]
‚Ä¢ Use the \"Excludes...\" button to preserve specific variable names
‚Ä¢ Critical for variables accessed via [code]set()[/code]/[code]get()[/code] with strings

[b]‚ö†Ô∏è Warning:[/b]
Variables accessed via string-based setters/getters MUST be excluded:
‚Ä¢ [code]set(\"variable_name\", value)[/code] - will break if variable_name obfuscated
‚Ä¢ [code]get(\"variable_name\")[/code] - will break if variable_name obfuscated

---

[b][size=14]3. Comment Removal[/size][/b]

[b]What it does:[/b]
‚Ä¢ Strips all comments from code (lines starting with [code]#[/code])

[b]What's preserved:[/b]
‚Ä¢ String literals containing [code]#[/code] are not affected
‚Ä¢ Example: [code]var url = \"https://example.com#anchor\"[/code] stays intact

[b]Purpose:[/b]
‚Ä¢ Makes reverse engineering harder by removing developer notes and explanations

[b]No exclude-list needed:[/b]
‚Ä¢ Comment removal is all-or-nothing (enable checkbox or don't)

---

[b][size=14]4. Testing & Best Practices[/size][/b]

[b]‚ö†Ô∏è Test Thoroughly:[/b]
‚Ä¢ Always test obfuscated builds before release

[b]‚ö†Ô∏è End-to-End Testing Required:[/b]
‚Ä¢ Obfuscation can easily break functionality anywhere in your game
‚Ä¢ Issues are difficult to detect without comprehensive e2e testing
‚Ä¢ Full end-to-end test coverage is critical after enabling obfuscation

[b]‚ö†Ô∏è Unit Testing:[/b]
‚Ä¢ Run thorough unit tests after making obfuscation changes
‚Ä¢ Test with obfuscation OFF, then ON to isolate issues

[b]‚ö†Ô∏è Not Encryption:[/b]
‚Ä¢ Obfuscation makes code harder to read, but NOT impossible
‚Ä¢ Determined reverse engineers can still understand obfuscated code
‚Ä¢ Think of it as a deterrent, not a lock

[b]‚ö†Ô∏è Keep Source Safe:[/b]
‚Ä¢ Always keep unobfuscated source code backed up separately
‚Ä¢ Your original source files are NEVER modified (obfuscation works on temp copies)
‚Ä¢ Store original source in version control (git, etc.)

[b]‚ö†Ô∏è Debugging Difficulty:[/b]
‚Ä¢ Obfuscated code is much harder to debug
‚Ä¢ Use obfuscation only for release builds, not during development
‚Ä¢ Error stack traces will show obfuscated names

---

[b][size=14]5. How Obfuscation Works[/size][/b]

[b]When it happens:[/b]
‚Ä¢ BEFORE Godot's export process (pre-processing step)
‚Ä¢ Source is copied to temp directory ‚Üí obfuscated ‚Üí then exported

[b]Where it happens:[/b]
‚Ä¢ Works on temporary copies in [code]user://temp/source/[/code]
‚Ä¢ Original project files are NEVER touched (zero risk of data loss)
‚Ä¢ Temp files are deleted after export completes

[b]How it works:[/b]
1. [b]Pass 1:[/b] Scan all .gd files to build symbol map
2. [b]Pass 2:[/b] Replace symbols with random names while preserving strings
3. [b]Export:[/b] Godot exports the obfuscated source for each platform

[b]Platform support:[/b]
‚Ä¢ ‚úÖ Windows builds - fully supported
‚Ä¢ ‚úÖ Linux builds - fully supported
‚Ä¢ ‚úÖ macOS builds - fully supported
‚Ä¢ ‚úÖ Web builds - fully supported
‚Ä¢ ‚úÖ Source exports - fully supported (for sharing obfuscated code)

[b]Obfuscation happens ONCE:[/b]
‚Ä¢ Single obfuscation pass for all selected platforms
‚Ä¢ Example: Exporting Windows + Web uses same obfuscated source

---

[b][size=14]6. Tips & Recommendations[/size][/b]

[b]üí° Tip: Incremental Adoption[/b]
Start with comment removal only, then gradually add function/variable obfuscation after thorough testing.

[b]üí° Tip: Use Version Control[/b]
Commit working code before enabling obfuscation, so you can easily revert if issues arise.

[b]üí° Tip: Test Exclude-Lists Early[/b]
If your game uses [code]set()[/code]/[code]get()[/code] or string-based reflection, identify those symbols and add them to exclude-lists BEFORE first obfuscated export.

[b]üí° Tip: Monitor Export Logs[/b]
Check godot-valet logs during export for any obfuscation errors or warnings."
fit_content = true
scroll_following = true

[node name="HSeparator" type="HSeparator" parent="MarginContainer/VBoxContainer"]
layout_mode = 2

[node name="CloseButton" type="Button" parent="MarginContainer/VBoxContainer"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 4
text = "Close"
